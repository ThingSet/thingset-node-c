# Copyright (c) The ThingSet Project Contributors
# SPDX-License-Identifier: Apache-2.0

config THINGSET
	bool "ThingSet Node Library"
	select REQUIRES_FULL_LIBC
	select ZCBOR
	select ZCBOR_CANONICAL
	select ZCBOR_STOP_ON_ERROR
	help
	  Enable the ThingSet node library.

if THINGSET

config THINGSET_IMMUTABLE_OBJECTS
	bool "Make data objects immutable and store them in ROM"
	default n
	help
	  This option adds const specifiers to the data object structs and stores them in iterable
	  sections in ROM instead of RAM.

	  The data itself still resides in RAM, only the pointers, object names, etc. are stored in
	  ROM, as they are not changed anyways.

	  The only disadvantage of this option is that no elements can be added to or removed from
	  subsets via the protocol anymore, as this information is now stored in read-only memory.

	  Possible future improvement: Store only subset information in RAM and the rest in ROM.

config THINGSET_NUM_JSON_TOKENS
	int "Maximum number of expected JSON tokens."
	default 50
	help
	  The maximum number of expected JSON tokens (arrays, map keys, values, primitives).

	  Trying to parse a request with more than the maximum number of tokens will result in an
	  error.

config THINGSET_64BIT_TYPES_SUPPORT
	bool "Enable support for 64 bit variable types."
	default n
	help
	  Switch on support for 64 bit variable types (uint64_t, int64_t, double).
	  This should be disabled for most 8-bit microcontrollers to increase performance.

config THINGSET_DECFRAC_TYPE_SUPPORT
	bool "Enable support for decimal fraction variable type."
	default n
	help
	  Switch on support for CBOR decimal fraction data type which stores a decimal mantissa
	  and a constant decimal exponent. This allows to use e.g. millivolts internally instead
	  of floating point numbers, while still communicating the SI base unit (volts).

config THINGSET_BYTES_TYPE_SUPPORT
	bool "Enable support for byte buffer variable type."
	select BASE64
	default n
	help
	  Switch on support for CBOR byte strings, which can store any sort of binary data and
	  can be used e.g. for firmware upgrades. JSON uses base64-encoded data.

config THINGSET_JSON_STRING_ESCAPING
	bool "Escape/unescape C strings when serializing/deserializing them to JSON"
	default n
	help
	  This is only required if arbitrary strings may end up in data objects of type String,
	  containing characters like the quotation mark that have to be escaped in JSON. This may
	  be the case if if ThingSet is used for logging.

config THINGSET_METADATA_ENDPOINT
	bool "Enable _Metadata endpoint"
	help
	  The _Metadata endpoint exposes a limited set of metadata like the variable name and type.

	  The endpoint is disabled by default in order to reduce memory footprint for constrained
	  devices.

module = THINGSET
module-str = thingset
source "subsys/logging/Kconfig.template.log_config"

endif
